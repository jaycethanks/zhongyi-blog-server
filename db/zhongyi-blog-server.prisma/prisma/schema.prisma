// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// 黑名单
model BlackList {
  id      String  @id @default(uuid())
  ip      String?
  email   String?
  keyword String?

  @@map("t_blacklist")
}

model Article {
  artid    String @id @default(uuid())
  order    Int    @unique @default(autoincrement())
  authorId String @map("author_id")

  title       String
  description String?
  content     String   @db.LongText

  keywords String @default("")
  status   Int    @default(0) //0: 草稿 1:发布 3：删除

  cover    String    @default("")
  password String? // 加密文章
  comments Comment[]

  allowComment Boolean @default(true) @map("allow_comment")
  liking       Int     @default(0)
  readers      Int     @default(0)
  banner       Int     @default(-1) //-1 不在 banner 区域展示， >0 banner 区域的顺序
  categories   String  @default("[]") // String[]

  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@map("t_articles")
}

model Comment {
  comid    String  @id @default(uuid())
  content  String  @db.TinyText
  nickname String?
  avatar   String?
  email    String?
  url      String?
  ip       String?
  agent    String?
  city     String?
  province String?

  sort   Int @default(0)
  liking Int @default(0)
  status Int @default(1) //0:隐藏 1:展示

  article Article @relation(fields:[articleId],references:[artid])  
  articleId          String @map("article_id")
  articleTitle       String? @map("article_title")
  articleDescription String? @map("article_description")

  parent         String?
  parentId       String?   @map("parent_id")
  parentNickname String?   @map("parent_nickname")

  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@map("t_comment")
}
